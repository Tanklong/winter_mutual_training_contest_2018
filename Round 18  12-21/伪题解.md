## Round 18

出题人：陈彦儒、杜振宇、陈雨硕

#### 阔爱的小活苗

设 $2^p \leq D$ 为最大的 $2$ 的次幂，显然原序列要以 $2^{p+1}$ 为周期。

考虑这样做，注意到 $2^{p-1}|2^p$，我们只需要每次把序列前一半和后一半变得一样，然后把序列长度缩小一半。

考虑操作长啥样，大概是 `0 0 0 1 1 1 1 0`，然后前一半减后一半大概就是 `-1 -1 -1 1`，反正就是一个形如一段-1一段1或者一段1一段-1的序列。差分一下就是 `-1 0 0 2` 之类的，也有可能是 `-1 0 0 0` 之类的。那么我们就可以编出策略，就只要把差分数组搞出来，然后先把后面的元素搞成0，再把第一个元素搞成0。

#### 矩阵玩小凹

答案是 $\sum_{i=1}^{\infty} P(\min s \geq i)(i^k-(i-1)^k)$，$P(\min{s} \geq i)=(1-P(s_1 <i))^n$。

容易看出 $P(s_1<i)=\sum_{j=0}^{i-1}(-1)^j(i-j)^m/j!/(m-j)!$，即如果不是 $[0,1]$ 随机，我们可以算出和 $<i$ 的体积就是 $i^m/m!$，然后我们容斥一下有几个 $\geq 1$ 的就好了。fft相信大家都会。

#### 人类的本质

设 $f(t)$ 为 $i=t$ 的答案，容易看出 $f$ 积性。算 $f$ 的素数幂比较容易，反正 $lcm,gcd$ 就变成 $max,min$ 了。如果 $k \leq 300$ 可以大力 min25 筛，否则 $n$ 很小，直接筛就好了。